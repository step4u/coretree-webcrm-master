<!DOCTYPE html>
<html ng-app="app" id="ng-app">
<head>
	<title>CRM with IPCC - Coretree</title>
  	<meta charset="utf-8">
  	<meta name="viewport" content="width=device-width, initial-scale=1">

	<script src="/resources/js/MessageValues.js"></script>
	<script src="/resources/jquery/jquery.min.js"></script>

    <link rel="stylesheet" href="/resources/css/main.css" />  	
    <link href="/resources/hoe/css/font-awesome.min.css" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Lato:100italic,100,300italic,300,400italic,400,700italic,700,900italic,900" rel="stylesheet" type="text/css">
    <link href="/resources/hoe/css/hoe.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
	
	<link rel="stylesheet" href="/resources/jquery-ui-1.11.4.custom/jquery-ui.min.css" />
	<script src="/resources/jquery-ui-1.11.4.custom/jquery-ui.min.js"></script>

	<link rel="stylesheet" href="/resources/bootstrap/css/bootstrap.min.css" />
	<link rel="stylesheet" href="resources/bootstrap/css/bootstrap-theme.min.css" />
	<script src="/resources/bootstrap/js/bootstrap.min.js"></script>
	<script src="/resources/hoe/js/hoe.js"></script>
	
	<script src="/resources/moment/moment-with-locales.min.js"></script>
	<link rel="stylesheet" href="/resources/eonasdan-bootstrap-datetimepicker/bootstrap-datetimepicker.min.css" />
	<script src="/resources/eonasdan-bootstrap-datetimepicker/bootstrap-datetimepicker.min.js"></script>
	
	<script src="https://code.angularjs.org/1.4.8/angular.min.js"></script>
	<script src="https://code.angularjs.org/1.4.8/angular-touch.min.js"></script>
	<script src="https://code.angularjs.org/1.4.8/angular-animate.min.js"></script>
	<script src="https://code.angularjs.org/1.4.8/angular-route.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.8/angular-cookies.min.js"></script>
	   
	<script src="https://cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/1.1.2/ui-bootstrap-tpls.min.js"></script>
	<script src="http://angular-ui.github.io/ui-router/release/angular-ui-router.js"></script>
	
	<script src="/resources/angularjs/grid-ui/grunt-scripts/csv.js"></script>
	<script src="/resources/angularjs/grid-ui/grunt-scripts/pdfmake.js"></script>
	<script src="/resources/angularjs/grid-ui/grunt-scripts/vfs_fonts.js"></script>
	   
	<script src="/resources/angularjs/grid-ui/3.0.7/ui-grid.min.js"></script>
	<link rel="stylesheet" href="/resources/angularjs/grid-ui/3.0.7/ui-grid.min.css" />
	
	<!-- <link rel="stylesheet" href="/resources/css/simple-sidebar.css" /> -->
	
	<script src="script1.js"></script>
	<script src="/resources/js/contextMenu.js"></script>
	
	<script src="/resources/js/sockjs-0.3.4.js"></script>
	<script src="/resources/js/stomp.js"></script>
	
	<script src="/resources/js/local.js"></script>
	<script src="/resources/js/funcs.js"></script>
	<script src="/resources/js/utility.js"></script>
	
	<script src="/resources/apps/CtrlCallstatus.js"></script>
	<script src="/resources/apps/CtrlExtState.js"></script>
	<script src="/resources/apps/CtrlCustomers.js"></script>
	<script src="/resources/apps/CtrlCalls.js"></script>
	<script src="/resources/apps/CtrlSms.js"></script>
	<script src="/resources/apps/CtrlRecords.js"></script>
	<script src="/resources/apps/CtrlExts.js"></script>
	<script src="/resources/apps/CtrlCounsellors.js"></script>
	<script src="/resources/apps/CtrlGroups.js"></script>
	<script src="/resources/apps/CtrlEmptyExtensions.js"></script>
	<script src="/resources/apps/CtrlStatistics01.js"></script>
	<script src="/resources/apps/CtrlStatistics02.js"></script>
	<script src="/resources/apps/CtrlStatistics03.js"></script>
</head>
<body hoe-navigation-type="vertical-compact" hoe-nav-placement="left" theme-layout="wide-layout" theme-bg="bg1">
	<div id="hoeapp-wrapper" class="hoe-hide-lpanel" hoe-device-type="desktop">
        <header id="hoe-header" hoe-lpanel-effect="shrink" class="hoe-minimized-lpanel">
            <div class="hoe-left-header">
                <a href="#"><i class="fa fa-cloud"></i> <span>Coretree IPCC</span></a>
                <span class="hoe-sidebar-toggle"><a href="#"></a></span>
            </div>

            <div class="hoe-right-header" hoe-position-type="relative" >
                <span class="hoe-sidebar-toggle"><a href="#"></a></span>
                <ul class="right-navbar">
					<li class="dropdown hoe-rheader-submenu hoe-header-profile">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown" id="sysinfo">
							<i class="fa fa-thumbs-o-up fa-fw"></i>
                            <span><b id="systeminfo"></b><i class=" fa fa-angle-down fa-fw"></i></span>
						</a>
						<ul class="dropdown-menu">
							<li><a href="#">디스크 용량 <span class="badge badge-danger" id="diskspace">3,123,123</span></a></li>
							<li><a href="#">금일 통화 <span class="badge badge-danger" id="todaycalls">223</span></a></li>
							<li><a href="#">주간 통화 <span class="badge badge-danger" id="weekcalls">1,235</span></a></li>
							<li><a href="#">월간 통화 <span class="badge badge-danger" id="monthcalls">19,546</span></a></li>
						</ul>
					</li>
					<li class="dropdown hoe-rheader-submenu hoe-header-profile">
						<a href="javascript:void(0)" class="dropdown-toggle" data-toggle="dropdown">
							<i class="fa fa-plus fa-fw"></i>
                            <span><b id="mystatusheader">온라인</b> <i class=" fa fa-angle-down fa-fw"></i></span>
						</a>
						<ul class="dropdown-menu ">
							<li><a href="javascript:void(0)" class="mystatus"><i class="fa fa-plus fa-fw"></i>온라인</a></li>
							<li><a href="javascript:void(0)" class="mystatus"><i class="fa fa-minus fa-fw"></i>자리비움</a></li>
							<!-- <li><a href="javascript:void(0)" class="mystatus"><i class="fa fa-times fa-fw"></i>수신거부</a></li> -->
							<li><a href="javascript:void(0)" class="mystatus"><i class="fa fa-mail-forward fa-fw"></i>착신전환</a></li>
							<li><a href="javascript:void(0)" id="/logout"><i class="fa fa-power-off fa-fw"></i>로그아웃</a></li>
						</ul>
					</li>
<!--
					<li class="dropdown hoe-rheader-submenu">
						<a href="#" class="dropdown-toggle icon-circle" data-toggle="dropdown"><i class="fa fa-ellipsis-h"></i></a> 
					</li>
-->
				</ul>
				
            </div>
        </header>
        <div id="hoeapp-container" hoe-color-type="lpanel-bg2" hoe-lpanel-effect="shrink" class="hoe-minimized-lpanel">
            <aside id="hoe-left-panel" hoe-position-type="absolute">
<!--             
                <div class="profile-box">
                    <div class="media">
                        <a class="pull-left" href="user-profile.html">
                            <img class="img-circle" src="/resources/hoe/images/avatar-1.jpg">
                        </a>
                        <div class="media-body">
                            <h5 class="media-heading">Welcome <span>James</span></h5>
                            <small>UX Designer</small>
                        </div>
                    </div>
                </div>
 -->
                <ul class="nav panel-list">
                    <!-- <li class="nav-level">Navigation</li> -->
					<li class="hoe-has-menu">
                        <a href="javascript:void(0)">
                            <i class="fa fa-book fa-fw"></i>
                            <span class="menu-text">주소록</span>
                            <span class="selected"></span>
                        </a>
                        <ul class="hoe-sub-menu">
                            <li>
                                <a href="#/addr/1/0">
                                    <span class="menu-text">공용 주소록</span>
                                    <span class="selected"></span>
                                </a>
                            </li>
                            <li>
                                <a href="#/addr/2/0">
                                    <span class="menu-text">개인 주소록</span>
                                    <span class="selected"></span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="#/calls">
                            <i class="fa fa-phone fa-fw"></i>
                            <span class="menu-text">통화 내역</span>
                            <span class="selected"></span>
                        </a>
                    </li>
                    <li>
                        <a href="#/smses">
                            <i class="fa fa-paper-plane fa-fw"></i>
                            <!-- <span class="menu-text">SMS 내역 <span class="badge badge-danger">N</span></span> -->
                            <span class="menu-text">SMS 내역</span>
                            <span class="selected"></span>
                        </a>
                    </li>
                    <li class="nav-level foradmin">관리자</li>
                    <li class="foradmin">
                        <a href="#/records">
                            <i class="fa fa-microphone fa-fw"></i>
                            <span class="menu-text">녹취 내역</span>
                            <span class="selected"></span>
                        </a>
                    </li>
                    <li class="foradmin">
                        <a href="#/exts">
                        	<i class="fa fa-phone-square fa-fw"></i>
                            <span class="menu-text">내선 관리</span>
                            <span class="selected"></span>
                        </a>
                    </li>
                    <li class="foradmin">
                        <a href="#/counsellors">
                        	<i class="fa fa-headphones fa-fw"></i>
                            <span class="menu-text">상담원 관리</span>
                            <span class="selected"></span>
                        </a>
                    </li>
					<li class="hoe-has-menu foradmin">
                        <a href="javascript:void(0)">
                            <i class="fa fa-bar-chart fa-fw"></i>
                            <span class="menu-text">통계</span>
                            <span class="selected"></span>
                        </a>
                        <ul class="hoe-sub-menu">
		                    <li>
		                        <a href="#/statistics01">
		                            <span class="menu-text">시간별 통화내역</span>
		                            <span class="selected"></span>
		                        </a>
		                    </li>
							<li>
		                        <a href="#/statistics02">
		                            <span class="menu-text">일별 통화내역</span>
		                            <span class="selected"></span>
		                        </a>
		                    </li>
							<li>
		                        <a href="#/statistics03">
		                            <span class="menu-text">월별 통화내역</span>
		                            <span class="selected"></span>
		                        </a>
		                    </li>
                        </ul>
					</li>
                </ul>
            </aside>
            <section id="main-content">
<!--
				<div class="content-title">
                    <h3 class="main-title">Sidebar Menu</h3>
                    <span>Sidebar Features</span>
                </div>
-->
 				<div class="inner-content" style="padding-top: 0px; padding-left: 15px;">
<!--
                     <div class="panel theme-panel">
                    
                        <div class="panel-heading">
                            <span class="panel-title">
								SideBar Menu Feature <i class="fa fa-bullhorn"></i>
							</span>
                        </div>
-->
                        <div class="panel-body">
                            <div class="row clearfix">
								<div class="col-md-9">
									<div class="row clearfix">
					                    <div class="alert alert-dismissable alert-info col-md-6" id="mainalert" style="height: 70px;">
					                        <!-- <button data-dismiss="alert" class="close" type="button">&times;</button> -->
					                        	온라인...
					                        <br />
					                        <br />
					                    </div>
					                    <div class="col-md-6">
					                    	<!-- <input type="text" class="form-control" id="callnumber" placeholder="전화번호" style="margin-bottom: 5px; width: 191px;"> -->
					                    	<div>
					                    		<button type="button" class="btn btn-primary btn-sm" id="btnCall">통화</button>
					                    		<button type="button" class="btn btn-primary btn-sm disabled" id="btnTransfer" style="margin-left: 8px;">전환</button>
					                    	</div>
					                    	<div style="margin-top: 9px;">
					                    		<button type="button" class="btn btn-primary btn-sm" id="btnPickup">당김</button>
					                    		<button type="button" class="btn btn-warning btn-sm disabled" id="btnHold" style="margin-left: 8px;">보류</button>
					                    	</div>
					                    </div>
				                    </div>
				                    <div class="row clearfix">
										<div ui-view="content"></div>
									</div>
					        	</div>
						        <div class="col-md-3">
						        	<div ng-controller="CtrlCallStatus" id="ctrlcallstatus">
						        		<div ui-grid="gridOptions" class="grid_teller_status"></div>
						        	</div>
									<div ng-controller="CtrlTelStatus" style="margin-top: 15px;" id="ctrlextstatus">
										<div ui-grid="gridOptions" class="grid_tels"></div>
									</div>
<!--
									<button type="button" class="btn btn-primary btn-sm" id='btn_connect'>Connect</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_disconnect'>Disconnect</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_makecall'>MakeCall</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_dropcall'>DropCall</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_holdcall'>HoldCall</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_activecall'>ActiveCall</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_transfer'>Transfer</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_pickup'>PickUp</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_reqextstatus'>Requset Extension Status</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_reqdnd'>Request DnD</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_dismissdnd'>Dismiss DnD</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_reqredirect'>Request Redirect</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_dismissredirect'>Dismiss Redirect</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_answer'>Answer</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_set_left'>Set Left</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_set_dnd'>Set Dnd</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_set_redirected'>Set Redirected</button>
									<button type="button" class="btn btn-primary btn-sm" id='btn_clear_set'>ClearSet</button>
-->
						        </div>
                            </div>
						</div>
<!-- 						
                    </div>
				</div>
 -->
            </section>
            
<!-- 
			<div id="styleSelector">
                <div class="selector-toggle">
                    <a href="javascript:void(0)"></a>
                </div>
                <ul>
                    <li>
                        <p class="selector-title">Style Selector</p>
                    </li>
                    <li class="theme-option">
                        <span class="sub-title">Header BG Color Option</span>
                        <div id="theme-color">
                            <a href="#" class="header-bg" hoe-color-type="header-bg1">&nbsp;</a>
                            <a href="#" class="header-bg" hoe-color-type="header-bg2">&nbsp;</a>
                            <a href="#" class="header-bg" hoe-color-type="header-bg3">&nbsp;</a>
                            <a href="#" class="header-bg" hoe-color-type="header-bg4">&nbsp;</a>
                            <a href="#" class="header-bg" hoe-color-type="header-bg5">&nbsp;</a>
                            <a href="#" class="header-bg" hoe-color-type="header-bg6">&nbsp;</a>
                            <a href="#" class="header-bg" hoe-color-type="header-bg7">&nbsp;</a>
                            <a href="#" class="header-bg" hoe-color-type="header-bg8">&nbsp;</a>
                            <a href="#" class="header-bg" hoe-color-type="header-bg9">&nbsp;</a>
                        </div>
                    </li>
                    <li class="theme-option">
                        <span class="sub-title">Left Panel BG Color Option</span>
                        <div id="theme-color">
                            <a href="#" class="lpanel-bg" hoe-color-type="lpanel-bg1">&nbsp;</a>
                            <a href="#" class="lpanel-bg" hoe-color-type="lpanel-bg2">&nbsp;</a>
                            <a href="#" class="lpanel-bg" hoe-color-type="lpanel-bg3">&nbsp;</a>
                            <a href="#" class="lpanel-bg" hoe-color-type="lpanel-bg4">&nbsp;</a>
                            <a href="#" class="lpanel-bg" hoe-color-type="lpanel-bg5">&nbsp;</a>
                            <a href="#" class="lpanel-bg" hoe-color-type="lpanel-bg6">&nbsp;</a>
                            <a href="#" class="lpanel-bg" hoe-color-type="lpanel-bg7">&nbsp;</a>
                            <a href="#" class="lpanel-bg" hoe-color-type="lpanel-bg8">&nbsp;</a>
                            <a href="#" class="lpanel-bg" hoe-color-type="lpanel-bg9">&nbsp;</a>
                        </div>
                    </li>
                    <li class="theme-option">
                        <span class="sub-title">Logo Color BG Option</span>
                        <div id="theme-color">
                            <a href="#" class="logo-bg" hoe-color-type="logo-bg1">&nbsp;</a>
                            <a href="#" class="logo-bg" hoe-color-type="logo-bg2">&nbsp;</a>
                            <a href="#" class="logo-bg" hoe-color-type="logo-bg3">&nbsp;</a>
                            <a href="#" class="logo-bg" hoe-color-type="logo-bg4">&nbsp;</a>
                            <a href="#" class="logo-bg" hoe-color-type="logo-bg5">&nbsp;</a>
                            <a href="#" class="logo-bg" hoe-color-type="logo-bg6">&nbsp;</a>
                            <a href="#" class="logo-bg" hoe-color-type="logo-bg7">&nbsp;</a>
                            <a href="#" class="logo-bg" hoe-color-type="logo-bg8">&nbsp;</a>
                            <a href="#" class="logo-bg" hoe-color-type="logo-bg9">&nbsp;</a>
                        </div>
                    </li>
					<li class="theme-option">
                        <span class="sub-title">Theme Background BG Option</span>
                        <div id="theme-color">
                            <a href="#" class="theme-bg" hoe-themebg-type="bg1">&nbsp;</a>
                            <a href="#" class="theme-bg" hoe-themebg-type="bg2">&nbsp;</a>
                            <a href="#" class="theme-bg" hoe-themebg-type="bg3">&nbsp;</a>
                            <a href="#" class="theme-bg" hoe-themebg-type="bg4">&nbsp;</a>
                            <a href="#" class="theme-bg" hoe-themebg-type="bg5">&nbsp;</a>
                            <a href="#" class="theme-bg" hoe-themebg-type="bg6">&nbsp;</a>
                            <a href="#" class="theme-bg" hoe-themebg-type="bg7">&nbsp;</a>
                            <a href="#" class="theme-bg" hoe-themebg-type="bg8">&nbsp;</a>
                            <a href="#" class="theme-bg" hoe-themebg-type="bg9">&nbsp;</a>
                        </div>
                    </li>
					<li class="theme-option">
                        <span class="sub-title">Theme Layout</span>
                        <select id="theme-layout" class="form-control minimal input-sm">
                            <option name="theme-layout" value="wide-layout">Wide Layout</option>
                            <option name="theme-layout" value="box-layout">Boxed Layout</option> 
                        </select>
                    </li>
                    <li class="theme-option">
                        <span class="sub-title">SideBar Effect</span>
                        <select id="leftpanel-effect" class="form-control minimal input-sm">
                            <option name="lpanel-effect" value="shrink">Default</option>
                            <option name="lpanel-effect" value="overlay">Overlay</option>
                            <option name="lpanel-effect" value="push">Push</option>
                        </select>
                    </li>
					<li class="theme-option">
                        <span class="sub-title">Navigation Type</span>
                        <select id="navigation-type" class="form-control minimal input-sm">
                            <option name="navigation-type" value="vertical">Vertical</option>
							<option name="navigation-type" value="vertical-compact">Vertical Compact</option>
                            <option name="navigation-type" value="horizontal">Horizontal</option>
							<option name="navigation-type" value="horizontal-compact">Horizontal compact</option>
                        </select>
                    </li>
					<li class="theme-option">
                        <span class="sub-title">Navigation Side</span>
                        <select id="navigation-side" class="form-control minimal input-sm">
                            <option name="navigation-side" value="leftside">Left</option>
							<option name="navigation-side" value="rightside">Right</option>
                        </select>
                    </li>
                    <li class="theme-option">
                        <span class="sub-title">Sidebar Position</span>
                        <select id="sidebar-position" class="form-control minimal input-sm">
                            <option name="sidebar-position" value="default">Default</option>
                            <option name="sidebar-position" value="fixed">Fixed</option>
                        </select>
                    </li>
                </ul>
            </div>
 -->
 
        </div>
    </div>

<!-- Customer Modal -->
<div class="modal fade" id="addCustomer" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">고객 등록</h4>
			</div>
			<div class="modal-body">
				<form class="form-horizontal" role="form">
					<input type="hidden" id="idx" />
					<div class="alert alert-warning fade in" style="display: none;" id="alertcust">
			  			<strong>Warning!</strong> This alert box could indicate a warning that might need attention.
					</div>
					<div class="form-group">
						<div class="col-sm-2">
							<label class="control-label" for="depthorder">그룹</label>
						</div>
						<div class="col-sm-4">
					    	<select class="form-control" id="maingroup">
					    		<option value="0">:: 메인그룹 ::</option>
					    		<option value="1">공용 주소록</option>
					    		<option value="2">개인 주소록</option>
					    	</select>
						</div>
						<div class="col-sm-4">
							<select class="form-control" id="subgroup">
					    		<option value="0">:: 서브그룹 ::</option>
					    	</select>
						</div>
						<div class="col-sm-2">
							<button type="button" class="btn btn-primary">추가</button>
						</div>
				  	</div>
					<div class="form-group">
						<div class="col-sm-2">
							<label for="uname">이름</label>
						</div>
				    	<div class="col-sm-4">
				    		<input type="text" class="form-control" id="uname" placeholder="이름">
				    	</div>
				  		<div class="col-sm-2">
				  			<label for="company">회사</label>
				  		</div>
				    	<div class="col-sm-4">
				    		<input type="text" class="form-control" id="firm" placeholder="회사">
				    	</div>				    	
				  	</div>
				  	<div class="form-group">
				  		<div class="col-sm-2">
				  			<label for="tel">전화</label>
				  		</div>
				    	<div class="col-sm-4">
				    		<input type="text" class="form-control" id="tel" placeholder="전화">
				    	</div>
				  		<div class="col-sm-2">
				  			<label for="cellular">휴대전화</label>
				  		</div>
				    	<div class="col-sm-4">
				    		<input type="text" class="form-control" id="cellular" placeholder="휴대전화">
				    	</div>
				  	</div>
				  	<div class="form-group">
				  		<div class="col-sm-2">
				  			<label for="extension">내선</label>
				  		</div>
				    	<div class="col-sm-4">
				    		<input type="text" class="form-control" id="extension" placeholder="내선">
				    	</div>
			    		<div class="col-sm-2">
			    			<label for="posi">직급</label>
			    		</div>
			    		<div class="col-sm-4">
			    			<input type="text" class="form-control" id="posi" placeholder="직급">
			    		</div>
				  	</div>
				  	<div class="form-group">
				  		<div class="col-sm-2">
				  			<label for="email">이메일</label>
				  		</div>
				    	<div class="col-sm-4">
				    		<input type="text" class="form-control" id="email" placeholder="이메일">
				    	</div>
			    	</div>
			</form>
      		</div>
      		<div class="modal-footer">
      			<div class="col-sm-12">
      				<span id="phonebtns" style="float: left; display: none;">
						<button type="button" class="btn btn-primary" id="btnMemoTake">받기</button>
	      				<button type="button" class="btn btn-primary disabled" id="btnMemoRedirect">전환</button>
	      				<button type="button" class="btn btn-warning disabled" id="btnMemoHold">보류</button>
	      				<button type="button" class="btn btn-danger" id="btnMemoHangup">종료</button>
      				</span>
      				<span style="float: right;">
		        		<button type="button" class="btn btn-primary" id="btnMemo" style="display: inline;">메모</button>
		        		<button type="button" class="btn btn-primary" id="btnSave">저장</button>
		        		<button type="button" class="btn btn-default" id="btnClose">닫기</button>
	        		</span>
        		</div>
      		</div>
    	</div>
  	</div>
</div>

<!-- Transfer Modal -->
<div class="modal fade" id="ModalTransfer" role="dialog">
	<div class="modal-dialog modal-sm">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">전화번호</h4>
			</div>
			<div class="modal-body">
				<div class="form-group">
					<input type="text" class="form-control" id="txtnumber">
				</div>
      		</div>
      		<div class="modal-footer">
        		<button type="button" class="btn btn-primary" id="btnTransferSend">확인</button>
        		<button type="button" class="btn btn-default" id="btnTransferClose">닫기</button>
      		</div>
    	</div>
  	</div>
</div>

<!-- Memo Modal -->
<div class="modal fade" id="Memo" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">메모</h4>
			</div>
			<div class="modal-body">
				<div class="form-group">
					<input type="hidden" id="call_idx">
					<textarea class="form-control" style="height: 275px;" id="memotxt"></textarea>
				</div>
      		</div>
      		<div class="modal-footer">
        		<button type="button" class="btn btn-primary" id="btnMemoSave">저장</button>
        		<button type="button" class="btn btn-default" id="btnMemoClose">닫기</button>
      		</div>
    	</div>
  	</div>
</div>

<!-- Sms Modal -->
<div class="modal fade" id="ModalSms" role="dialog">
	<div class="modal-dialog modal-sm">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">SMS</h4>
			</div>
			<div class="modal-body">
				<div class="form-group">
					<div>
						<label for="receivephones">받는번호</label>
					</div>
					<div>
						<input type="text" class="form-control" id="receivephones" readonly style="margin-bottom: 5px;" />
					</div>
				</div>
				<div class="form-group">
					<div>
						<textarea class="form-control" style="height: 150px;" id="smstxt" maxlength="80"></textarea>
					</div>
				</div>
      		</div>
      		<div class="modal-footer">
        		<button type="button" class="btn btn-primary" id="btnSmsSend">보내기</button>
        		<button type="button" class="btn btn-default" id="btnSmsClose">닫기</button>
      		</div>
    	</div>
  	</div>
</div>
<audio controls id="audioplayer" style="display: none;"></audio>

<script>
/*
    (function() {
        var socket = new SockJS('/webcrm');
        var stompClient = Stomp.over(socket);

        var appModel = new ApplicationModel(stompClient);
        ko.applyBindings(appModel);

        appModel.connect();
        appModel.pushNotification("Trade results take a 2-3 second simulated delay. Notifications will appear.");
	})();
*/

	var worker;
	function connect() {
        worker = new Worker('resources/js/ExtStatus_multi-worker.js');

        /* 	        worker.addEventListener('message', function(e) {
        	// update_ext_status(e.data);
        	console.log("worker front side got message...." + e.data);
        }); */
        
        worker.onmessage = function (event) {
        	update_ext_status(event.data);
		};

        var command = {
        	cmd: 'connect'
        }
        worker.postMessage(JSON.stringify(command));
	}

	var whoami;
	var stompClient;
	
    function connect2() {
        var socket = new SockJS('/webcrm');
        stompClient = Stomp.over(socket);
        stompClient.outgoing = 20000;
        stompClient.incoming = 20000;
        
        stompClient.connect({}, function(frame) {
        	whoami = frame.headers['user-name'];

            stompClient.subscribe("/topic/ext.state.*", function(message) {
            	var data = JSON.parse(message.body);
                update_ext_status(data);
                SetCallState(data);
            });
            
            stompClient.subscribe("/user/queue/groupware", function(message) {
            	TreatMySelf(JSON.parse(message.body));
			});
            
            stompClient.subscribe("/user/queue/errors", function(message) {
            	console.log('index.html /app/queue/errors: ' + JSON.parse(message.body));
			});
            
            RequestExtState();
            InitializeExts();
            // setInterval(SetCallState, 2000);
        });
    }
    
    function disconnect() {
        if (stompClient != null) {
            stompClient.disconnect();
        }
        // setConnected(false);
        console.log("Disconnected");
    }
    
    function sendName() {
        var name = document.getElementById('name').value;
        stompClient.send("/user/hello", {}, JSON.stringify({ 'name': name }));
    }
</script>

<script>
    function update_ext_status(data){
    	var scope = angular.element($("#ctrlextstatus")).scope();
	    scope.$apply(function () {
	        scope.updateExtStatus(data);
	    });
    }
    
	$(document).ready(function(){
	    $("#btn_connect").click(function(){
	    	//connect();
	    	connect2();
	    });
		
	    $("#btn_disconnect").click(function(){
			disconnect();
	    });
	    
	    $("#btn_makecall").click(function(){
	    	// makecall
	        trade = {
	                cmd : 74,
	                extension : '3001',
	                caller : '3001',
	                callee : '01045455962',
	                unconditional : '',
	                status: -1
	              };
	        
	     	stompClient.send("/app/traders", {}, JSON.stringify(trade));
	        console.log("socktest sock sent");
	    });
	    
	    $("#btn_dropcall").click(function(){
	    	// pickup
	        trade = {
	                cmd : 76,
	                extension : '3001',
	                caller : '3001',
	                callee : '01045455962',
	                unconditional : '',
	                status: -1
	              };
	        
	     	stompClient.send("/app/traders", {}, JSON.stringify(trade));
	        console.log("socktest sock sent");
	    });
	    
	    $("#btn_holdcall").click(function(){
	    	// pickup
	        trade = {
	                cmd : 82,
	                extension : '3001',
	                caller : '01045455962',
	                callee : '3001',
	                unconditional : '',
	                status: -1
	              };
	        
	     	stompClient.send("/app/traders", {}, JSON.stringify(trade));
	        console.log("socktest sock sent");
	    });
	    
	    $("#btn_activecall").click(function(){
	    	// pickup
	        trade = {
	                cmd : 84,
	                extension : '3001',
	                caller : '01045455962',
	                callee : '3001',
	                unconditional : '',
	                status: -1
	              };
	        
	     	stompClient.send("/app/traders", {}, JSON.stringify(trade));
	        console.log("socktest sock sent");
	    });
	    
	    $("#btn_transfer").click(function(){
	    	// transfer
	        trade = {
	                cmd : 86,
	                extension : '3001',
	                caller : '01045455962',
	                callee : '3001',
	                unconditional : '3002',
	                status: -1
	              };
	        
	     	stompClient.send("/app/traders", {}, JSON.stringify(trade));
	        console.log("socktest sock sent");
	    });
	    
	    $("#btn_pickup").click(function(){
	    	// pickup
	        trade = {
	                cmd : 80,
	                extension : '3002',
	                caller : '',
	                callee : '3001',
	                unconditional : '',
	                status: -1
	              };
	        
	     	stompClient.send("/app/traders", {}, JSON.stringify(trade));
	        console.log("socktest sock sent");
	    });
	    
	    $("#btn_reqextstatus").click(function(){
	    	// Requset Extension Status
	        trade = {
                cmd: 64,
              };
	    	
	     	stompClient.send("/app/traders", {}, JSON.stringify(trade));
	        console.log("socktest sock sent");
	    });
	    
	    $("#btn_reqdnd").click(function(){
	    	// Requset DnD
	    	
	        trade = {
                cmd: UC_SET_SRV_REQ,
                direct: 0,
                call_idx: 0,
                extension: '3001',
                cust_idx: 0,
                caller: '',
                callername: '',
                callee: '',
                calleename: '',
                responseCode: UC_SRV_DND,
                unconditional: '',
                status: 0
			};
	        
	     	stompClient.send("/app/traders", {}, JSON.stringify(trade));
	    });
	    
	    $("#btn_dismissdnd").click(function(){
	    	// Dismiss DnD
	    	
	        trade = {
                cmd: UC_CLEAR_SRV_REQ,
                direct: 0,
                call_idx: 0,
                extension: '3001',
                cust_idx: 0,
                caller: '',
                callername: '',
                callee: '',
                calleename: '',
                responseCode: UC_SRV_DND,
                unconditional: '',
                status: 0
			};
	        
	     	stompClient.send("/app/traders", {}, JSON.stringify(trade));
	    });
	    
	    $("#btn_reqredirect").click(function(){
	    	// Requset Redirect
	    	
	        trade = {
                cmd: UC_SET_SRV_REQ,
                direct: 0,
                call_idx: 0,
                extension: '3001',
                cust_idx: 0,
                caller: '',
                callername: '',
                callee: '',
                calleename: '',
                responseCode: UC_SRV_UNCONDITIONAL,
                unconditional: '3002',
                status: 0
			};
	        
	     	stompClient.send("/app/traders", {}, JSON.stringify(trade));
	    });
	    
	    $("#btn_dismissredirect").click(function(){
	    	// Requset Redirect
	    	
	        trade = {
                cmd: UC_CLEAR_SRV_REQ,
                direct: 0,
                call_idx: 0,
                extension: '3001',
                cust_idx: 0,
                caller: '',
                callername: '',
                callee: '',
                calleename: '',
                responseCode: UC_SRV_UNCONDITIONAL,
                unconditional: '',
                status: 0
			};
	        
	     	stompClient.send("/app/traders", {}, JSON.stringify(trade));
	    });
	    
	    $("#btn_answer").click(function(){
	    	// Requset UC_ANSWER_CALL_REQ
	    	
	        trade = {
                cmd: UC_ANWSER_CALL_REQ,
                direct: UC_DIRECT_INCOMING,
                call_idx: 0,
                extension: '3001',
                cust_idx: 0,
                caller: '01045455962',
                callername: '',
                callee: '',
                calleename: '',
                responseCode: '',
                unconditional: '',
                status: 0
			};
	        
	     	stompClient.send("/app/traders", {}, JSON.stringify(trade));
	    });
	    
	    $("#btn_set_left").click(function(){
	        trade = {
	                cmd: UC_SET_SRV_REQ,
	                direct: UC_DIRECT_INCOMING,
	                call_idx: 0,
	                extension: '3001',
	                cust_idx: 0,
	                caller: '01045455962',
	                callername: '',
	                callee: '',
	                calleename: '',
	                responseCode: '',
	                unconditional: '',
	                status: 0
				};
		        
		     	stompClient.send("/app/traders", {}, JSON.stringify(trade));
	    });
	    
		connect2();
	});
</script>
</body>
</html>
